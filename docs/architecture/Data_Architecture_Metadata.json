{
  "session_id": "7f3a8b2c-9e4d-4a1f-b8c5-6d7e9f1a2b3c",
  "timestamp": "2026-02-03T12:00:00Z",
  "inputs": {
    "folder_paths": [
      "z:\\LogicApp"
    ],
    "target_layer": "Data",
    "quality_level": "standard",
    "output_sections": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9
    ],
    "include_diagrams": true
  },
  "statistics": {
    "components_discovered": 12,
    "relationships_mapped": 18,
    "dependencies_identified": {
      "upstream": 5,
      "downstream": 5
    },
    "diagrams_generated": 7,
    "source_files_analyzed": 25,
    "execution_time_seconds": 180
  },
  "components": [
    {
      "id": "DATA-DB-001",
      "name": "OrderDbContext",
      "type": "EF Core DbContext",
      "source_file": "z:\\LogicApp\\src\\eShop.Orders.API\\data\\OrderDbContext.cs",
      "purpose": "Central database context for order management"
    },
    {
      "id": "DATA-ENT-001",
      "name": "OrderEntity",
      "type": "Database Entity",
      "source_file": "z:\\LogicApp\\src\\eShop.Orders.API\\data\\Entities\\OrderEntity.cs",
      "purpose": "Represents orders in the database"
    },
    {
      "id": "DATA-ENT-002",
      "name": "OrderProductEntity",
      "type": "Database Entity",
      "source_file": "z:\\LogicApp\\src\\eShop.Orders.API\\data\\Entities\\OrderProductEntity.cs",
      "purpose": "Represents order line items"
    },
    {
      "id": "DATA-REPO-001",
      "name": "OrderRepository",
      "type": "Data Repository",
      "source_file": "z:\\LogicApp\\src\\eShop.Orders.API\\Repositories\\OrderRepository.cs",
      "purpose": "Data access layer for orders"
    },
    {
      "id": "DATA-MIG-001",
      "name": "OrderDbV1 Migration",
      "type": "EF Migration",
      "source_file": "z:\\LogicApp\\src\\eShop.Orders.API\\Migrations\\20251227014858_OrderDbV1.cs",
      "purpose": "Initial database schema creation"
    },
    {
      "id": "DATA-INFRA-001",
      "name": "Azure SQL Server",
      "type": "Cloud Database",
      "source_file": "z:\\LogicApp\\infra\\shared\\data\\main.bicep",
      "purpose": "Managed relational database service"
    },
    {
      "id": "DATA-INFRA-002",
      "name": "OrderDb Database",
      "type": "SQL Database",
      "source_file": "z:\\LogicApp\\infra\\shared\\data\\main.bicep",
      "purpose": "Application database instance"
    },
    {
      "id": "DATA-INFRA-003",
      "name": "Workflow Storage Account",
      "type": "Azure Storage",
      "source_file": "z:\\LogicApp\\infra\\shared\\data\\main.bicep",
      "purpose": "Blob/File/Table/Queue storage"
    },
    {
      "id": "DATA-INFRA-004",
      "name": "SQL Private Endpoint",
      "type": "Network Security",
      "source_file": "z:\\LogicApp\\infra\\shared\\data\\main.bicep",
      "purpose": "Private connectivity to SQL Server"
    },
    {
      "id": "DATA-INFRA-005",
      "name": "Storage Private Endpoints",
      "type": "Network Security",
      "source_file": "z:\\LogicApp\\infra\\shared\\data\\main.bicep",
      "purpose": "Private connectivity to storage services"
    },
    {
      "id": "DATA-HC-001",
      "name": "DbContextHealthCheck",
      "type": "Health Monitor",
      "source_file": "z:\\LogicApp\\src\\eShop.Orders.API\\HealthChecks\\DbContextHealthCheck.cs",
      "purpose": "Database connectivity health check"
    },
    {
      "id": "DATA-SEC-001",
      "name": "Entra ID Authentication",
      "type": "Security",
      "source_file": "z:\\LogicApp\\infra\\shared\\data\\main.bicep",
      "purpose": "Managed identity authentication"
    }
  ],
  "validation_scores": {
    "completeness": 0.92,
    "togaf_compliance": 0.90,
    "quality": 0.88,
    "overall": 0.90
  },
  "warnings": [
    "GDPR data erasure not fully implemented (DeleteOrdersByCustomerIdAsync missing)",
    "Disaster recovery testing schedule not established",
    "Data masking not implemented for non-production environments",
    "Outbox pattern not implemented (eventual consistency risk)"
  ],
  "recommendations": [
    "Implement GDPR-compliant data erasure (soft delete with retention period)",
    "Establish quarterly disaster recovery testing schedule",
    "Configure dynamic data masking for development/test environments",
    "Implement Outbox pattern for transactional message publishing",
    "Add data validation job to verify Order.Total accuracy",
    "Consider read replicas for reporting workloads (reduce primary DB load)",
    "Implement customer-managed keys (CMK) for enhanced security (if required)"
  ],
  "key_findings": {
    "maturity_level": "Level 3 - Defined",
    "data_stores": {
      "relational": "Azure SQL Database (OrderDb, 2 vCores, 32GB)",
      "blob": "3 containers (success, errors, completed)",
      "file": "5GB workflow state share"
    },
    "security_posture": {
      "authentication": "Entra ID-only (SQL auth disabled)",
      "network": "Private endpoints, zero public exposure",
      "encryption": "TLS 1.2 in transit, TDE at rest"
    },
    "performance": {
      "query_p95": "~80ms",
      "availability": "99.99% (Azure SLA)",
      "rto": "< 30 minutes",
      "rpo": "< 10 minutes"
    }
  },
  "phase_execution": {
    "phase1_discovery": {
      "status": "completed",
      "duration_seconds": 45,
      "files_scanned": 25,
      "components_found": 12
    },
    "phase2_analysis": {
      "status": "completed",
      "duration_seconds": 30,
      "relationships_mapped": 18,
      "dependencies_identified": 10
    },
    "phase3_generation": {
      "status": "completed",
      "duration_seconds": 90,
      "sections_generated": 9,
      "diagrams_created": 7
    },
    "phase4_validation": {
      "status": "completed",
      "duration_seconds": 15,
      "validations_passed": 3,
      "issues_found": 4
    }
  },
  "document_info": {
    "title": "TOGAF 10 Data Architecture Document",
    "layer": "Data",
    "version": "1.0",
    "status": "Current Baseline",
    "total_sections": 9,
    "total_pages_estimated": 85,
    "total_words_estimated": 25000,
    "diagrams": [
      "Architecture Landscape Overview (flowchart)",
      "Entity-Relationship Diagram (ER diagram)",
      "Data Flow Patterns (flowchart)",
      "Data Security Architecture (graph)",
      "Data Architecture Context (C4 diagram)",
      "Network Topology (network diagram)",
      "End-to-End Data Flow (sequence diagram)"
    ]
  },
  "compliance_summary": {
    "encryption_at_rest": "Compliant",
    "encryption_in_transit": "Compliant",
    "network_isolation": "Compliant",
    "authentication": "Compliant",
    "audit_logging": "Compliant",
    "backup_recovery": "Partial",
    "gdpr_readiness": "Partial",
    "data_masking": "Not Implemented",
    "disaster_recovery_testing": "Not Implemented",
    "overall_score": "70%"
  }
}
